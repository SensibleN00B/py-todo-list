{% extends "base.html" %}

{% block title %}Todo List{% endblock %}

{% block content %}

  <div class="d-flex justify-content-between align-items-center mb-3 mt-1">
    <h1 class="h3">Tasks</h1>
    <a class="btn btn-primary" href="{% url 'todo_list:task-create' %}">Add task</a>
  </div>


  {% if tasks %}
    <div class="list-group">
      {% for task in tasks %}
        <div class="list-group-item shadow-sm">
          <div class="d-flex justify-content-between">
            <div>
              <strong>{{ task.content }}</strong>
              {% if task.is_done %}
                <span class="badge bg-success ms-2">Done</span>
              {% else %}
                <span class="badge bg-secondary ms-2">Not done</span>
              {% endif %}

              <div class="small text-muted mt-1">
                Created: {{ task.created_at|date:"Y-m-d H:i" }}
                {% if task.deadline %} â€¢ Deadline: {{ task.deadline|date:"Y-m-d H:i" }}{% endif %}
              </div>

              {% if task.tags.all %}
                <div class="mt-1">
                  {% for tag in task.tags.all %}
                    <span class="badge badge-tag text-dark">#{{ tag.name }}</span>
                  {% empty %}
                  {% endfor %}
                </div>
              {% endif %}
            </div>

            <div class="d-flex gap-2 task-actions">
              {% if task.is_done %}
                <a class="btn btn-success btn-sm" href="{% url 'todo_list:task-toggle' task.pk %}">Undo</a>
              {% else %}
                <a class="btn btn-success btn-sm" href="{% url 'todo_list:task-toggle' task.pk %}">Complete</a>
              {% endif %}
              <a class="btn btn-primary btn-sm" href="{% url 'todo_list:task-update' task.pk %}">Update</a>
              <a class="btn btn-danger btn-sm" href="{% url 'todo_list:task-delete' task.pk %}">Delete</a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No tasks yet. Click "Add task".</p>
  {% endif %}
{% endblock %}